<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>힐러 유형 진단</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 10px;
            overflow-x: hidden;
            line-height: 1.6;
        }

        /* iframe 호환성을 위한 추가 스타일 */
        html, body {
            width: 100%;
            height: 100%;
        }

        body {
            overflow-y: auto;
        }

        .container {
            background: white;
            border-radius: 24px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
            max-width: 700px;
            width: 100%;
            margin: 20px auto;
            overflow: hidden;
            min-height: 500px;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-align: center;
            padding: 40px 30px;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="1"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
            opacity: 0.3;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 15px;
            text-shadow: 2px 2px 8px rgba(0,0,0,0.3);
            position: relative;
            z-index: 1;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.95;
            position: relative;
            z-index: 1;
        }

        .content {
            padding: 50px 40px;
            text-align: center;
        }

        .question-selection h2 {
            color: #2d3748;
            margin-bottom: 35px;
            font-size: 2em;
            font-weight: 600;
        }

        .option-buttons {
            display: grid;
            gap: 20px;
            max-width: 500px;
            margin: 0 auto;
        }

        .option-btn {
            padding: 20px 30px;
            border: none;
            border-radius: 16px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-size: 1.2em;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 600;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
            position: relative;
            overflow: hidden;
        }

        .option-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .option-btn:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 15px 35px rgba(102, 126, 234, 0.4);
        }

        .option-btn:hover::before {
            left: 100%;
        }

        .quiz-container {
            display: none;
        }

        .progress-section {
            margin-bottom: 40px;
        }

        .question-counter {
            text-align: center;
            color: #4a5568;
            font-size: 1.3em;
            margin-bottom: 25px;
            font-weight: 600;
        }

        .progress-bar {
            background: #e2e8f0;
            border-radius: 12px;
            height: 12px;
            overflow: hidden;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }

        .progress {
            background: linear-gradient(90deg, #667eea, #764ba2);
            height: 100%;
            border-radius: 12px;
            transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
        }

        .question-card {
            background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 35px;
            border-left: 6px solid #667eea;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
        }

        .question-text {
            font-size: 1.4em;
            color: #2d3748;
            margin-bottom: 35px;
            line-height: 1.6;
            font-weight: 500;
        }

        .answer-options {
            display: grid;
            gap: 15px;
        }

        .answer-btn {
            padding: 18px 25px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            background: white;
            color: #4a5568;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 1.1em;
            font-weight: 500;
            position: relative;
            overflow: hidden;
        }

        .answer-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 0;
            height: 100%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            transition: width 0.3s ease;
            z-index: -1;
        }

        .answer-btn:hover {
            border-color: #667eea;
            color: #667eea;
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2);
        }

        .answer-btn.selected {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-color: #667eea;
            transform: translateX(5px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .answer-btn.selected::before {
            width: 100%;
        }

        .next-btn {
            background: linear-gradient(135deg, #48bb78, #38a169);
            color: white;
            border: none;
            padding: 18px 45px;
            border-radius: 12px;
            font-size: 1.2em;
            cursor: pointer;
            margin-top: 30px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 600;
            box-shadow: 0 8px 25px rgba(72, 187, 120, 0.3);
        }

        .next-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 30px rgba(72, 187, 120, 0.4);
        }

        .next-btn:disabled {
            background: #cbd5e0;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .result-container {
            display: none;
            text-align: center;
        }

        .result-score {
            font-size: 3.5em;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 800;
            margin: 30px 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .result-title {
            font-size: 2.2em;
            color: #2d3748;
            margin-bottom: 25px;
            font-weight: 700;
        }

        .result-subtitle {
            font-size: 1.4em;
            color: #667eea;
            margin-bottom: 30px;
            font-weight: 600;
            font-style: italic;
        }

        .result-description {
            font-size: 1.2em;
            color: #4a5568;
            line-height: 1.7;
            max-width: 600px;
            margin: 0 auto 40px;
        }

        .restart-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 18px 35px;
            border-radius: 12px;
            font-size: 1.2em;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 600;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .restart-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 30px rgba(102, 126, 234, 0.4);
        }

        @media (max-width: 768px) {
            body {
                padding: 5px;
            }
            
            .container {
                margin: 10px auto;
                border-radius: 20px;
                min-height: 400px;
            }
            
            .header {
                padding: 30px 20px;
            }
            
            .content {
                padding: 30px 25px;
            }

            .header h1 {
                font-size: 2em;
            }

            .question-text {
                font-size: 1.2em;
            }

            .option-btn, .answer-btn {
                padding: 15px 20px;
                font-size: 1em;
            }
        }

        @media (max-width: 400px) {
            .header h1 {
                font-size: 1.7em;
            }
            
            .header p {
                font-size: 1em;
            }
            
            .question-text {
                font-size: 1.1em;
            }
            
            .option-btn, .answer-btn {
                padding: 12px 18px;
                font-size: 0.95em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🎯 힐러 유형 진단</h1>
            <p>당신은 어떤 타입의 힐러인가요?</p>
        </div>

        <div class="content">
            <!-- 시작 화면 -->
            <div id="start-screen">
                <div class="question-selection">
                    <h2>진단을 시작해보세요!</h2>
                    <div class="option-buttons">
                        <button class="option-btn" onclick="startQuiz()">
                            ✨ 힐러 유형 진단 시작 (20문항)
                        </button>
                    </div>
                </div>
            </div>

            <!-- 퀴즈 화면 -->
            <div id="quiz-screen" class="quiz-container">
                <div class="progress-section">
                    <div class="question-counter">
                        <span id="current-question">1</span> / <span id="total-questions">20</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress" id="progress"></div>
                    </div>
                </div>
                <div class="question-card">
                    <div class="question-text" id="question-text">
                        질문이 여기에 표시됩니다.
                    </div>
                    <div class="answer-options" id="answer-options">
                        <button class="answer-btn" data-value="5">매우 그렇다</button>
                        <button class="answer-btn" data-value="4">그렇다</button>
                        <button class="answer-btn" data-value="3">보통이다</button>
                        <button class="answer-btn" data-value="2">그렇지 않다</button>
                        <button class="answer-btn" data-value="1">매우 그렇지 않다</button>
                    </div>
                </div>
                <button class="next-btn" id="next-btn" onclick="nextQuestion()" disabled>
                    다음 질문
                </button>
            </div>

            <!-- 결과 화면 -->
            <div id="result-screen" class="result-container">
                <div class="result-score" id="score">85점</div>
                <div class="result-title" id="result-title">퓨어 힐러</div>
                <div class="result-subtitle" id="result-subtitle">"나는 힐러다. 그 외엔 관심 없다."</div>
                <div class="result-description" id="result-description">
                    결과 설명이 여기에 표시됩니다.
                </div>
                <button class="restart-btn" onclick="restart()">
                    🔄 다시 진단하기
                </button>
            </div>
        </div>
    </div>

    <script>
        // 질문 데이터 (질문, 정방향여부)
        const questionsData = [
            ["힐러의 본질은 힐을 하는 것이라고 생각한다.", true],
            ["힐보다는 딜을 활용해 플레이에 기여하는 것이 좋다.", false],
            ["승리보다는 팀원들이 즐겁게 플레이하는 것이 더 중요하다.", true],
            ["파티의 안정성을 높이는 것은 힐이라고 생각한다.", true],
            ["아군의 체력 바가 비어있는 것을 보지 못한다.", true],
            ["경쟁보다는 협력을 통해 목표를 달성하는 것을 선호한다.", true],
            ["게임에서 화려한 스킬보다는 안정적인 플레이를 선호한다.", true],
            ["내가 힐러일 때 아군의 죽음은 용납할 수 없다.", true],
            ["전투에서 직접 공격하기보다는 지원하는 것이 더 재미있다.", true],
            ["팀 전체의 상황을 파악하며 플레이를 하는 것이 자연스럽다.", true],
            ["플레이를 이끄는 것보다 지원하는 것이 좋다.", true],
            ["힐과 딜을 유연하게 넘나들며 플레이하는 것을 선호한다.", false],
            ["서포터의 본질은 피해의 근원을 찾아 없애는 것이다.", false],
            ["팀원과 적극적으로 소통하며 게임하는 것을 좋아한다.", true],
            ["개인 기록보다 팀 성과에 더 관심이 많다.", true],
            ["혼자서는 할 수 없는 일을 팀과 함께 해낼 때 보람을 느낀다.", true],
            ["아군이 위험한 순간, 회복보다는 위험의 대상을 제거한다.", false],
            ["내 캐릭터가 죽더라도 팀원을 살리려고 한다.", true],
            ["게임에서 가장 중요한 것은 팀원과의 신뢰 관계다.", true],
            ["팀을 지키는 역할에서 자부심을 느낀다.", true]
        ];

        let currentQuestionIndex = 0;
        let totalScore = 0;
        let selectedAnswer = null;

        function startQuiz() {
            document.getElementById('start-screen').style.display = 'none';
            document.getElementById('quiz-screen').style.display = 'block';
            document.getElementById('total-questions').textContent = questionsData.length;
            
            showQuestion();
            adjustIframeHeight();
        }

        function showQuestion() {
            const questionText = document.getElementById('question-text');
            const currentQuestionSpan = document.getElementById('current-question');
            const progress = document.getElementById('progress');
            const nextBtn = document.getElementById('next-btn');
            
            questionText.textContent = questionsData[currentQuestionIndex][0];
            currentQuestionSpan.textContent = currentQuestionIndex + 1;
            progress.style.width = ((currentQuestionIndex + 1) / questionsData.length) * 100 + '%';
            
            // 선택 초기화
            selectedAnswer = null;
            const answerBtns = document.querySelectorAll('.answer-btn');
            answerBtns.forEach(btn => btn.classList.remove('selected'));
            nextBtn.disabled = true;
            
            if (currentQuestionIndex === questionsData.length - 1) {
                nextBtn.textContent = '결과 보기';
            }
            
            adjustIframeHeight();
        }

        function selectAnswer(value) {
            selectedAnswer = value;
            const answerBtns = document.querySelectorAll('.answer-btn');
            answerBtns.forEach(btn => btn.classList.remove('selected'));
            
            const selectedBtn = event.target;
            selectedBtn.classList.add('selected');
            
            document.getElementById('next-btn').disabled = false;
        }

        function nextQuestion() {
            if (selectedAnswer === null) return;
            
            // 정방향/역방향에 따른 점수 계산
            const isForward = questionsData[currentQuestionIndex][1];
            let score;
            
            if (isForward) {
                score = selectedAnswer; // 정방향: 매우 그렇다 = 5점
            } else {
                score = 6 - selectedAnswer; // 역방향: 매우 그렇지 않다 = 5점
            }
            
            totalScore += score;
            currentQuestionIndex++;
            
            if (currentQuestionIndex >= questionsData.length) {
                showResult();
            } else {
                showQuestion();
            }
        }

        function showResult() {
            document.getElementById('quiz-screen').style.display = 'none';
            document.getElementById('result-screen').style.display = 'block';
            
            const scoreElement = document.getElementById('score');
            const titleElement = document.getElementById('result-title');
            const subtitleElement = document.getElementById('result-subtitle');
            const descriptionElement = document.getElementById('result-description');
            
            const maxScore = questionsData.length * 5;
            const percentage = (totalScore / maxScore) * 100;
            
            scoreElement.textContent = `${totalScore}점`;
            
            let title, subtitle, description;
            
            if (percentage >= 81) {
                title = "퓨어 힐러";
                subtitle = '"나는 힐러다. 그 외엔 관심 없다."';
                description = "힐에 올인하는 힐러 스타일로, 파티의 생존을 최우선으로 두고 안정적 플레이를 선호합니다. 아군이 위험한 순간 누구보다 먼저 달려가 구할 당신은 퓨어 힐러입니다!";
            } else if (percentage >= 61) {
                title = "중도힐러";
                subtitle = '"힐도 딜도 놓치지 않는 유연한 스타일"';
                description = "힐도 딜도 놓치지 않는 유연한 스타일로, 올라운더를 지향합니다. 파티 상태와 전투 흐름을 보며 전략적으로 역할을 변경하는 당신은 반반무마니입니다!";
            } else {
                title = "딜힐러";
                subtitle = '"피해의 근원을 찾아 제거하는 자, 그것이 진정한 지원가."';
                description = "힐보다 딜에 비중을 더 많이 두는 힐러 스타일로, 힐러 탈을 쓴 딜러입니다. 아군이 죽기 전 상대를 먼저 제거하는 당신은 딜힐러입니다!";
            }
            
            titleElement.textContent = title;
            subtitleElement.textContent = subtitle;
            descriptionElement.textContent = description;
            
            adjustIframeHeight();
        }

        function restart() {
            document.getElementById('result-screen').style.display = 'none';
            document.getElementById('start-screen').style.display = 'block';
            
            // 초기화
            currentQuestionIndex = 0;
            totalScore = 0;
            selectedAnswer = null;
            
            adjustIframeHeight();
        }

        // iframe 메시지 통신 (부모 창과의 높이 조정)
        function adjustIframeHeight() {
            if (window.parent !== window) {
                const height = document.body.scrollHeight;
                window.parent.postMessage({
                    type: 'resize',
                    height: height
                }, '*');
            }
        }

        // 페이지 로드 시 높이 조정
        window.addEventListener('load', adjustIframeHeight);
        
        // 콘텐츠 변경 시 높이 조정
        const observer = new MutationObserver(adjustIframeHeight);
        observer.observe(document.body, {
            childList: true,
            subtree: true,
            attributes: true
        });

        // 답변 버튼에 이벤트 리스너 추가
        document.addEventListener('DOMContentLoaded', function() {
            const answerBtns = document.querySelectorAll('.answer-btn');
            answerBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const value = parseInt(this.getAttribute('data-value'));
                    selectAnswer(value);
                });
            });
            
            // 초기 높이 조정
            adjustIframeHeight();
        });
    </script>
</body>
</html>